version: 1.0.{build}
image: Visual Studio 2017
configuration: Release
environment:
  CODECOV_TOKEN:
    secure: WKM1Gl75ti8xxft9eyooyDV6JGRPjgn8pLfnUnYOf7gMPAbD2q7mvMKE4oOrjU4U
dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'
before_build:
- choco install codecov
build_script:
- cmd: >-
    dotnet build -c Release

    dotnet pack -c Release
test_script:
- cmd: dotnet test -c Release --no-build --no-restore --test-adapter-path:. --logger:Appveyor /p:CollectCoverage=true /p:CoverletOutputFormat="opencover" /p:CoverletOutput=../lcov
- cmd: codecov -f "lcov.opencover.xml"
artifacts:
- path: '**\*.nupkg'
deploy:
- provider: NuGet
  api_key:
    secure: KvCsSP9GBIWOq9YWTpUK2iqjXeyMd/gv20zDXVHA5et7TR3nMHZKr0hcfsY5wt1N
skip_commits:
  files:
    - '**/*.md'     